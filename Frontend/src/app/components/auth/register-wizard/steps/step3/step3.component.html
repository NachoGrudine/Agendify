<div class="step-container">
  <!-- Título -->
  <div class="step-header">
    <div class="step-badge">Paso 3 de 3</div>
    <h2 class="step-title">Configura tu perfil profesional</h2>
    <p class="step-description">Personaliza cómo te verán tus clientes en la plataforma.</p>
  </div>

  <!-- Avatar Section -->
  <div class="avatar-section">
    <div class="avatar-wrapper">
      @if (avatarPreview()) {
        <img [src]="avatarPreview()" alt="Avatar preview" class="avatar-image" />
      } @else {
        <div class="avatar-placeholder">
          <svg class="avatar-icon" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
          </svg>
        </div>
      }
      <label for="avatar-upload" class="avatar-upload-btn">
        <svg class="upload-icon" viewBox="0 0 20 20" fill="currentColor">
          <path d="M5.5 13a3.5 3.5 0 01-.369-6.98 4 4 0 117.753-1.977A4.5 4.5 0 1113.5 13H11V9.413l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13H5.5z"/>
          <path d="M9 13h2v5a1 1 0 11-2 0v-5z"/>
        </svg>
      </label>
      <input
        id="avatar-upload"
        type="file"
        accept="image/*"
        class="avatar-input"
        (change)="onFileSelected($event)"
      />
    </div>
  </div>

  <!-- Formulario -->
  <form class="step-form" (ngSubmit)="onSubmit()">
    <!-- Nombre Profesional -->
    <div class="form-group">
      <label for="providerName" class="form-label">
        Nombre Profesional
      </label>
      <input
        id="providerName"
        type="text"
        [(ngModel)]="providerName"
        name="providerName"
        placeholder="Ej. Juan Pérez"
        class="form-input"
        [class.input-error]="errors().providerName"
        autocomplete="name"
      />
      @if (errors().providerName) {
        <span class="error-message">{{ errors().providerName }}</span>
      }
    </div>

    <!-- Especialidad (Opcional) -->
    <div class="form-group">
      <label for="providerSpecialty" class="form-label">
        Especialidad <span class="optional-label">(Opcional)</span>
      </label>
      <input
        id="providerSpecialty"
        type="text"
        [(ngModel)]="providerSpecialty"
        name="providerSpecialty"
        placeholder="Ej. Estilista Senior"
        class="form-input"
        autocomplete="off"
      />
    </div>

    <!-- Info Box -->
    <div class="info-box">
      <svg class="info-box-icon" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
      </svg>
      <p class="info-box-text">
        No te preocupes, podrás añadir a más profesionales y miembros de tu equipo una vez finalizado el registro.
      </p>
    </div>

    <!-- Botones de navegación -->
    <div class="button-row">
      <button type="button" class="btn-secondary" (click)="onBack()" [disabled]="isSubmitting()">
        Volver
      </button>
      <button type="submit" class="btn-primary" [disabled]="isSubmitting()">
        @if (isSubmitting()) {
          <svg class="spinner" viewBox="0 0 24 24">
            <circle class="spinner-circle" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"/>
          </svg>
          Finalizando...
        } @else {
          Finalizar registro
          <svg class="btn-icon" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
          </svg>
        }
      </button>
    </div>
  </form>

  <!-- Footer -->
  <div class="step-footer">
    <p class="footer-text">
      &copy; 2024 Agendify SaaS. Todos los derechos reservados.
      <a href="#" class="footer-link">¿Necesitas ayuda? Contacta con soporte</a>
    </p>
  </div>
</div>
